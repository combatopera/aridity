diff --git a/aridity/context.py b/aridity/context.py
index be85996..fee0112 100644
--- a/aridity/context.py
+++ b/aridity/context.py
@@ -53,6 +53,8 @@ class SuperContext:
 
 supercontext = SuperContext()
 
+class NoSuchPathException(Exception): pass
+
 class Context:
 
     def __init__(self, parent = supercontext):
@@ -78,11 +80,22 @@ class Context:
             return self.parent[name]
 
     def resolved(self, name):
-        obj = self[name].resolve(self)
+        try:
+            r = self[name].resolve
+        except KeyError:
+            r = lambda context: Fork(context, collections.OrderedDict())
+        obj = r(self)
         prefix = name + '#'
+        seen = set()
         for name in self.names():
             if name.startswith(prefix):
-                modname = name[len(prefix):]
-                if '#' not in modname:
+                start = len(prefix)
+                end = name.find('#', start)
+                if -1 == end:
+                    end = None
+                modname = name[start:end]
+                name = name[:end]
+                if name not in seen:
+                    seen.add(name)
                     obj.modify(modname, self.resolved(name))
         return obj
